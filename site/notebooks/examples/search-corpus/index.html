
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="An intuitive, fast-paced introduction to Retrieval Augmented Generation (RAG)">
      
      
        <meta name="author" content="SupportVectors">
      
      
        <link rel="canonical" href="https://supportvectors.ai/rag-to-riches/notebooks/examples/search-corpus/">
      
      
        <link rel="prev" href="../lesson-2/">
      
      
        <link rel="next" href="../semantic-search/">
      
      
      <link rel="icon" href="../../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>Search corpus - SupportVectors Rag to Riches</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Lora";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/supportvectors.css">
    
      <link rel="stylesheet" href="../../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="gray">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#toy-corpus-for-semantic-search" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="SupportVectors Rag to Riches" class="md-header__button md-logo" aria-label="SupportVectors Rag to Riches" data-md-component="logo">
      
  <img src="../../../images/overlapping_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SupportVectors Rag to Riches
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Search corpus
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="gray"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="SupportVectors Rag to Riches" class="md-nav__button md-logo" aria-label="SupportVectors Rag to Riches" data-md-component="logo">
      
  <img src="../../../images/overlapping_logo.png" alt="logo">

    </a>
    SupportVectors Rag to Riches
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RAG to Riches: Advanced Retrieval-Augmented Generation Framework
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Corpus
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Corpus
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../corpus/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Corpus Package: Data Models and Content Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../corpus/AnimalQuote/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AnimalQuote Class: Individual Quote Data Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../corpus/AnimalWisdom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AnimalWisdom Class: Quote Collection Management
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../corpus/Animals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Animals Class: Complete RAG System
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples Package
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Exceptions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Exceptions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../exceptions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exceptions Package
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Notebooks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lesson-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lesson-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lesson 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Search corpus
    
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../semantic-search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Semantic search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../supportvectors-common/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Supportvectors common
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Project guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Project guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tips and tricks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Tips and tricks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../project-guide/tips-and-tricks/cuda-hell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Some tips and tricks to deal with the CUDA hell
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Search
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Search
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Search Package
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Search basics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Search basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../search_basics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Search Basics Package
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Start simply
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Start simply
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../start_simply/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Start Simply Package
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utils Package
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Vectordb
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Vectordb
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../vectordb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vector Database Package: Embeddings and Storage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../vectordb/EmbeddedVectorDB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EmbeddedVectorDB Class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../vectordb/SimpleTextEmbedder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SimpleTextEmbedder Class
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script>
(function() {
  function addWidgetsRenderer() {
    var requireJsScript = document.createElement('script');
    requireJsScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js';

    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var jupyterWidgetsScript = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    jupyterWidgetsScript.src = widgetRendererSrc;

    document.body.appendChild(requireJsScript);
    document.body.appendChild(jupyterWidgetsScript);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="toy-corpus-for-semantic-search">Toy corpus for semantic search<a class="headerlink" href="#toy-corpus-for-semantic-search" title="Permanent link">&para;</a></h1>
<p>Here, we create a toy corpus comprising of a few small document texts. Then we will make this the context of semantic search.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1">#</span>
<span class="c1"># From &quot;Through the looking Glass&quot; by Lewis Caroll</span>
<span class="c1">#</span>
<span class="n">jabberwocky</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">’Twas brillig, and the slithy toves</span>
<span class="s2">      Did gyre and gimble in the wabe:</span>
<span class="s2">All mimsy were the borogoves,</span>
<span class="s2">      And the mome raths outgrabe.</span>

<span class="s2">“Beware the Jabberwock, my son!</span>
<span class="s2">      The jaws that bite, the claws that catch!</span>
<span class="s2">Beware the Jubjub bird, and shun</span>
<span class="s2">      The frumious Bandersnatch!”</span>

<span class="s2">He took his vorpal sword in hand;</span>
<span class="s2">      Long time the manxome foe he sought—</span>
<span class="s2">So rested he by the Tumtum tree</span>
<span class="s2">      And stood awhile in thought.</span>

<span class="s2">And, as in uffish thought he stood,</span>
<span class="s2">      The Jabberwock, with eyes of flame,</span>
<span class="s2">Came whiffling through the tulgey wood,</span>
<span class="s2">      And burbled as it came!</span>

<span class="s2">One, two! One, two! And through and through</span>
<span class="s2">      The vorpal blade went snicker-snack!</span>
<span class="s2">He left it dead, and with its head</span>
<span class="s2">      He went galumphing back.</span>

<span class="s2">“And hast thou slain the Jabberwock?</span>
<span class="s2">      Come to my arms, my beamish boy!</span>
<span class="s2">O frabjous day! Callooh! Callay!”</span>
<span class="s2">      He chortled in his joy.</span>

<span class="s2">’Twas brillig, and the slithy toves</span>
<span class="s2">      Did gyre and gimble in the wabe:</span>
<span class="s2">All mimsy were the borogoves,</span>
<span class="s2">      And the mome raths outgrabe.</span>

<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1">#</span>
<span class="c1"># The beginning of the &quot;Tale of two cities&quot;, by Charles Dickens</span>
<span class="c1">#</span>
<span class="n">best_of_times</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">It was the best of times, it was the worst of times, </span>
<span class="s2">it was the age of wisdom, it was the age of foolishness, </span>
<span class="s2">it was the epoch of belief, it was the epoch of incredulity, </span>
<span class="s2">it was the season of light, it was the season of darkness, </span>
<span class="s2">it was the spring of hope, it was the winter of despair, </span>
<span class="s2">we had everything before us, we had nothing before us, </span>
<span class="s2">we were all going direct to heaven, </span>
<span class="s2">we were all going direct the other way–in short, </span>
<span class="s2">the period was so far like the present period, </span>
<span class="s2">that some of its noisiest authorities insisted on its being received, </span>
<span class="s2">for good or for evil, in the superlative degree of comparison only.</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1">#</span>
<span class="c1"># From the &quot;Tale of two cities&quot; by Charles Dickens</span>
<span class="c1">#</span>
<span class="n">mystery</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">A wonderful fact to reflect upon, that every human creature is </span>
<span class="s2">constituted to be that profound secret and mystery to every other. </span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1">#</span>
<span class="c1"># A poignant passage from the &quot;Tale of two cities&quot;, by Charles Dickens</span>
<span class="c1">#</span>
<span class="n">last_dream</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">I wish you to know that you have been the last dream of my soul. </span>
<span class="s2">In my degradation I have not been so degraded but that the sight </span>
<span class="s2">of you with your father, and of this home made such a home by you, </span>
<span class="s2">has stirred old shadows that I thought had died out of me. </span>
<span class="s2">Since I knew you, I have been troubled by a remorse that I </span>
<span class="s2">thought would never reproach me again, and have heard whispers </span>
<span class="s2">from old voices impelling me upward, that I thought were silent </span>
<span class="s2">for ever. I have had unformed ideas of striving afresh, beginning anew, </span>
<span class="s2">shaking off sloth and sensuality, and fighting out the abandoned fight. </span>
<span class="s2">A dream, all a dream, that ends in nothing, and leaves the sleeper </span>
<span class="s2">where he lay down, but I wish you to know that you inspired it.</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">mark_twain_dog</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">The dog is a gentleman; I hope to go to his heaven not man&#39;s.</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">einstein</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;If a man aspires towards a righteous life, his first act of abstinence is from injury to animals.&quot;&quot;&quot;</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">tweedledee</span>  <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Tweedledum and Tweedledee: She then meets the fat twin brothers </span>
<span class="s2">Tweedledum and Tweedledee, whom she knows from the nursery rhyme. </span>
<span class="s2">After reciting the long poem &quot;The Walrus and the Carpenter&quot;, </span>
<span class="s2">they draw Alice&#39;s attention to the Red King—loudly snoring away </span>
<span class="s2">under a nearby tree—and maliciously provoke her with idle philosophical </span>
<span class="s2">banter that she exists only as an imaginary figure in the Red King&#39;s dreams. </span>
<span class="s2">Finally, the brothers begin suiting up for battle, only to be frightened </span>
<span class="s2">away by an enormous crow, as the nursery rhyme about them predicts.</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">goldens_1</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Golden retrievers are not bred to be guard dogs, and considering the size of their hearts and their irrepressible joy and life, they are less likely to bite than to bark, less likely to bark than to lick a hand in greeting. In spite of their size, they think they are lap dogs, and in spite of being dogs, they think they’re also human, and nearly every human they meet is judged to have the potential to be a boon companion who might at any moment, cry, “Let’s go!” and lead them on a great adventure.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">goldens_2</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">If you’re lucky, a golden retriever will come into your life, steal your heart, and change everything</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">goldens_3</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">My friend Phil has a theory that the Lord, having made teenagers, felt constrained to make amends and so created the golden retriever.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">dog_soul</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">If you don’t believe that dogs have souls, you haven’t looked into their eyes long enough.</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">keats</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">A thing of beauty is a joy for ever:</span>
<span class="s2">Its loveliness increases; it will never</span>
<span class="s2">Pass into nothingness; but still will keep</span>
<span class="s2">A bower quiet for us, and a sleep</span>
<span class="s2">Full of sweet dreams, and health, and quiet breathing.</span>
<span class="s2">Therefore, on every morrow, are we wreathing</span>
<span class="s2">A flowery band to bind us to the earth,</span>
<span class="s2">Spite of despondence, of the inhuman dearth</span>
<span class="s2">Of noble natures, of the gloomy days,</span>
<span class="s2">Of all the unhealthy and o&#39;er-darkn&#39;d ways</span>
<span class="s2">Made for our searching: yes, in spite of all,</span>
<span class="s2">Some shape of beauty moves away the pall</span>
<span class="s2">From our dark spirits. Such the sun, the moon,</span>
<span class="s2">Trees old and young, sprouting a shady boon</span>
<span class="s2">For simple sheep; and such are daffodils</span>
<span class="s2">With the green world they live in; and clear rills</span>
<span class="s2">That for themselves a cooling covert make</span>
<span class="s2">&#39;Gainst the hot season; the mid-forest brake,</span>
<span class="s2">Rich with a sprinkling of fair musk-rose blooms:</span>
<span class="s2">And such too is the grandeur of the dooms</span>
<span class="s2">We have imagined for the mighty dead;</span>
<span class="s2">An endless fountain of immortal drink,</span>
<span class="s2">Pouring unto us from the heaven&#39;s brink</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">attention</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">The dominant sequence transduction models are based on </span>
<span class="s2">complex recurrent or convolutional neural networks in an encoder-decoder configuration. </span>
<span class="s2">The best performing models also connect the encoder and decoder through </span>
<span class="s2">an attention mechanism. We propose a new simple network architecture, </span>
<span class="s2">the Transformer, based solely on attention mechanisms, </span>
<span class="s2">dispensing with recurrence and convolutions entirely. </span>
<span class="s2">Experiments on two machine translation tasks show these models </span>
<span class="s2">to be superior in quality while being more parallelizable </span>
<span class="s2">and requiring significantly less time to train. </span>
<span class="s2">Our model achieves 28.4 BLEU on the WMT 2014 English-to-German translation task, </span>
<span class="s2">improving over the existing best results, including ensembles by over 2 BLEU. </span>
<span class="s2">On the WMT 2014 English-to-French translation task, our model establishes </span>
<span class="s2">a new single-model state-of-the-art BLEU score of 41.8 after training for </span>
<span class="s2">3.5 days on eight GPUs, a small fraction of the training costs of the </span>
<span class="s2">best models from the literature. We show that the Transformer </span>
<span class="s2">generalizes well to other tasks by applying it successfully to </span>
<span class="s2">English constituency parsing both with large and limited training data.</span>

<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">backprop</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">In machine learning, backpropagation</span>
<span class="s2">(backprop,[1] BP) is a widely used</span>
<span class="s2">algorithm for training feedforward</span>
<span class="s2">artificial neural networks.</span>
<span class="s2">Generalizations of backpropagation</span>
<span class="s2">exist for other artificial neural</span>
<span class="s2">networks (ANNs), and for functions</span>
<span class="s2">generally. These classes of algorithms</span>
<span class="s2">are all referred to generically as</span>
<span class="s2">&quot;backpropagation&quot;.[2] In fitting a</span>
<span class="s2">neural network, backpropagation</span>
<span class="s2">computes the gradient of the loss</span>
<span class="s2">function with respect to the weights of</span>
<span class="s2">the network for a single input–output</span>
<span class="s2">example, and does so efficiently,</span>
<span class="s2">unlike a naive direct computation of</span>
<span class="s2">the gradient with respect to each</span>
<span class="s2">weight individually. This efficiency</span>
<span class="s2">makes it feasible to use gradient</span>
<span class="s2">methods for training multilayer</span>
<span class="s2">networks, updating weights to minimize</span>
<span class="s2">loss; gradient descent, or variants</span>
<span class="s2">such as stochastic gradient descent,</span>
<span class="s2">are commonly used. The backpropagation</span>
<span class="s2">algorithm works by computing the</span>
<span class="s2">gradient of the loss function with</span>
<span class="s2">respect to each weight by the chain</span>
<span class="s2">rule, computing the gradient one layer</span>
<span class="s2">at a time, iterating backward from the</span>
<span class="s2">last layer to avoid redundant</span>
<span class="s2">calculations of intermediate terms in</span>
<span class="s2">the chain rule; this is an example of</span>
<span class="s2">dynamic programming.[3]</span>
<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1"># Wordsworth</span>
<span class="n">lucy</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">She dwelt among the untrodden ways</span>
<span class="s2">Beside the springs of Dove,</span>
<span class="s2">A Maid whom there were none to praise</span>
<span class="s2">And very few to love:</span>

<span class="s2">A violet by a mossy stone</span>
<span class="s2">Half hidden from the eye!</span>
<span class="s2">—Fair as a star, when only one</span>
<span class="s2">Is shining in the sky.</span>

<span class="s2">She lived unknown, and few could know</span>
<span class="s2">When Lucy ceased to be;</span>
<span class="s2">But she is in her grave, and, oh,</span>
<span class="s2">The difference to me!</span>

<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Davies</span>
<span class="n">full_of_cares</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">What is this life if, full of care,</span>
<span class="s2">We have no time to stand and stare.</span>

<span class="s2">No time to stand beneath the boughs</span>
<span class="s2">And stare as long as sheep or cows.</span>

<span class="s2">No time to see, when woods we pass,</span>
<span class="s2">Where squirrels hide their nuts in grass.</span>

<span class="s2">No time to see, in broad daylight,</span>
<span class="s2">Streams full of stars, like skies at night.</span>

<span class="s2">No time to turn at Beauty&#39;s glance,</span>
<span class="s2">And watch her feet, how they can dance.</span>

<span class="s2">No time to wait till her mouth can</span>
<span class="s2">Enrich that smile her eyes began.</span>

<span class="s2">A poor life this if, full of care,</span>
<span class="s2">We have no time to stand and stare.</span>


<span class="s2">&quot;&quot;&quot;</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">sentences</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">jabberwocky</span><span class="p">,</span> <span class="n">best_of_times</span><span class="p">,</span> <span class="n">last_dream</span><span class="p">,</span> <span class="n">mystery</span><span class="p">,</span> <span class="n">mark_twain_dog</span><span class="p">,</span> <span class="n">einstein</span><span class="p">,</span>
    <span class="n">tweedledee</span><span class="p">,</span> <span class="n">goldens_1</span><span class="p">,</span> <span class="n">goldens_2</span><span class="p">,</span> <span class="n">goldens_3</span><span class="p">,</span> <span class="n">dog_soul</span><span class="p">,</span> <span class="n">keats</span><span class="p">,</span> <span class="n">attention</span><span class="p">,</span> <span class="n">backprop</span><span class="p">,</span> <span class="n">lucy</span><span class="p">,</span> <span class="n">full_of_cares</span>
<span class="p">]</span>
</code></pre></div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>
</code></pre></div>

</div>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>